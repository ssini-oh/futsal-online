# Futsal Online

## 프로젝트 개요

**Futsal Online**은 간단한 풋살 카드 게임 프로젝트로, Prisma와 Node.js를 기반으로 개발된 팀 프로젝트입니다. 사용자들은 카드를 수집하고 덱을 구성하여 다른 플레이어와 대결을 펼칠 수 있으며, 현재 백엔드 API 중심으로 설계되었습니다.

---

## 주요 기능

### 사용자 관리

- 회원가입 및 로그인
- JWT를 이용한 인증
- 사용자 정보 관리 (캐시 관리, 승리/패배 기록)

### 카드 및 덱 관리

- **카드 수집**: 가챠 시스템을 통해 카드를 수집
  - 카드 속성:
    - 태클, 피지컬, 파워, 드리블 스탯
    - 카드 등급 (노말, 레어, 에픽, 레전더리)
    - 진영 (총 10개 진영)
    - 카드 타입 (공격수/수비수)
- **덱 구성**: 최대 3장의 카드를 선택하여 덱 구성
- **덱 관리**:
  - 덱에 카드 추가 및 삭제
  - 중복 카드 추가 방지 로직 적용

### 게임 시뮬레이션

- 턴제 시뮬레이션 방식으로 진행
- 수비수(CardType.DEFENDER)와 공격수(CardType.ATTACKER)에 따른 확률 기반 로직
- 진영(TeamColorType)에 따른 버프 효과 적용

---

## 게임 로직

### 기본 설정

- **스탯 가중치**:
  - 공격: 파워(0.3), 드리블(0.2)
  - 수비: 태클(0.2), 피지컬(0.3)
- **진영 가중치**:
  - 진영에 따른 추가 점수 (최대 20점)
- **포지션 보정**:
  - 공격수와 수비수 비율에 따라 추가 점수 적용 (5점)
- **게임 규칙**:
  - 팀당 선수 3명
  - 최대 15라운드 진행

### 확률 계산 과정

1. **스탯 기반 확률 계산**:
   - 각 팀의 스탯 합계를 기반으로 공격/수비 점수 계산
2. **포지션 별 확률 조정**:
   - 공격수와 수비수 비율에 따라 공격/수비 점수 보정
3. **진영 별 확률 조정**:
   - 팀 색상에 따라 추가 점수 반영
4. **확률 보정**:
   - 최소 1%에서 최대 99%로 확률 제한

### 경기 진행

- 각 라운드에서 다음 로직을 반복:
  1. A팀 공격, B팀 수비:
     - A팀 공격 확률이 B팀 수비 확률을 초과하면 A팀 득점 (랜덤)
  2. B팀 공격, A팀 수비:
     - B팀 공격 확률이 A팀 수비 확률을 초과하면 B팀 득점 (랜덤)
- 최종 점수를 통해 승패 결정

### 결과 저장 및 반환

- **데이터 저장**:
  - 경기 결과를 데이터베이스에 기록 (득점, 팀 정보 등)
- **결과 반환**:
  - WIN, LOSE, DRAW 상태 반환 및 최종 점수 포함

---

## 기술 스택

### Backend

- **Node.js**: 서버 개발
- **Express**: API 구축
- **Prisma**: ORM 및 데이터베이스 관리
- **MySQL**: 데이터 저장
- **bcrypt**: 비밀번호 암호화
- **dotenv**: 환경 변수 관리
- **jsonwebtoken**: JWT 인증 처리
- **Joi**: 데이터 유효성 검사

### Tools

- **Nodemon**: 개발 중 서버 자동 재시작
- **Prettier**: 코드 스타일 자동화
- **Insomnia**: API 테스트
- **GitHub**: 협업 및 버전 관리

---

## 설치 및 실행 방법

### 1. 레포지토리 클론

```bash
git clone https://github.com/ssini-oh/futsal-online.git
cd futsal-online
```

### 2. 패키지 설치

```bash
yarn install
```

### 3. 환경 변수 설정

`.env` 파일 생성 후, 아래 항목 설정:

```
DATABASE_URL=mysql://<username>:<password>@<host>:<port>/<database>
JWT_SECRET=<your_jwt_secret>
```

### 4. 데이터베이스 설정

```bash
npx prisma db push
```

### 5. 서버 실행

```bash
yarn start
```

---

## 협업 및 회고

### 협업 과정

- 기초 게임 기획 및 와이어프레임 설계
- ERD 설계 및 테이블 스키마 작성
- 역할 분담 후 GitHub를 이용한 PR 기반 협업
- Insomnia를 활용한 주요 기능 테스트
- 최종 PR(Merge) 후 전체적인 테스트 진행

### 회고

이 프로젝트는 기획부터 개발, 테스트까지 팀원들과 함께하며 협업의 중요성을 실감한 경험이었습니다. 초기 설계 단계에서 큰 그림을 명확히 하고, 각자의 역할을 충실히 수행하며 프로젝트를 진행했습니다. 코드 리뷰와 테스트 과정을 통해 문제를 빠르게 해결하고 효율적으로 작업할 수 있었습니다.

- **성공**: 설계와 테스트 과정에서 원활한 소통으로 높은 품질의 결과물을 도출했습니다.
- **아쉬운 점**: 테이블 스키마 설계가 부족해 개발 중간에 몇 차례 수정이 필요했던 점이 아쉬웠습니다.
- **배운 점**: 초기 설계의 중요성과 명확한 역할 분담의 필요성을 느꼈고, 지속적인 팀원 간 소통이 얼마나 중요한지 배웠습니다.

---

## 라이선스

MIT License
